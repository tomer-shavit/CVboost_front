import Head from "next/head";
import { PageLayout } from "@/components/PageLayout";
import { useState } from "react";
import ApiLoader from "../components/ApiLoader";
import useApi from "@/hooks/useApi";
import PreUpload from "@/components/PreUpload";
import PostUpload from "@/components/PostUpload";

export default function Home() {
  const [file, setFile] = useState<File | undefined>();
  const { data, isLoading, error } = useApi(
    "http://localhost:7071/api/ResumeTrigger",
    file,
    "resume"
  );

  const test_res = {
    bullet_points: ["bullet 1", "bullet 2", "bullet 3", "bullet 4"],
    score: 80,
    feedback:
      "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor" +
      " incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat." +
      " Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, " +
      "sunt in culpa qui officia deserunt mollit anim id est laborum.",
    edited_lines: [],
  };

  var body;
  if (file == null && isLoading == false) {
    body = <PreUpload setFile={setFile}></PreUpload>;
  } else if (isLoading == true) {
    body = <ApiLoader></ApiLoader>;
  } else if (file && isLoading == false && data != undefined) {
    body = <PostUpload file={file} data={data}></PostUpload>;
  }

  // if (file == null && isLoading == false) {
  //   body = <PreUpload setFile={setFile}></PreUpload>;
  // } else if (file != undefined) {
  //   body = <PostUpload file={file} data={test_res}></PostUpload>;
  // }

  // body = <ApiLoader></ApiLoader>;

  return (
    <>
      <Head>
        <title>CVBoost</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <PageLayout>{body}</PageLayout>
    </>
  );
}
